!function(t){"use strict";function e(e){var r=t(e.currentTarget);if(!r.hasClass(l)){u.removeClass(l),r.addClass(l);var a=e.currentTarget.dataset.condition,o={pageUrl:location.href,pageRef:u.closest(".tm-woo-grid-list-toggle-button-wrapper").data("page-referrer")};t.cookie(f,a,{expires:365,path:"/"}),t.tmWcProductsAjax(o)}}function r(e){if(tmWooAjaxProducts.ajaxPagination){e.preventDefault();var r={pageUrl:e.currentTarget.href};t.tmWcProductsAjax(r)}}function a(e){e.preventDefault();var r=t(i),a=r.find(".product").length,c=t(e.currentTarget),n={pageUrl:e.currentTarget.dataset.href,action:"tm_wc_load_more",productsCount:a};c.addClass("loading"),t.post(tmWooAjaxProducts.ajaxurl,n,function(e){if(c.removeClass("loading"),e.success){var r=t(i);r.find(".product").last().after(e.data.products),c.replaceWith(e.data.button);var a=t.Event("tm_wc_products_changed");t(document).trigger(a),o()}})}function o(){t(c).off("change","select.orderby"),s=t(n),u=s.find(d),u.off("click"),u.on("click",function(t){e(t)}),t(c).on("change","select.orderby",function(e){t.tmWcOrderingHandler(e)}),t(m).off("click"),t(m).on("click",function(t){r(t)}),t(p).off("click"),t(p).on("click",function(t){a(t)})}var c=".woocommerce-ordering",n=".tm-woo-grid-list-toggle-button",d=".tm-woo-grid-list-toggler",i=".tm-wc-ajax-products-wrapper",s=t(n),u=s.find(d),l="disabled",f="tm-woo-grid-list",g=(t(i),t(".woocommerce-breadcrumb")),m=".woocommerce-pagination a.page-numbers",p="button.tm-wc-ajax-load-more-button";t.tmWcProductsAjax=function(e){var r=t(i);r.addClass("loading"),e.action="tm_wc_rebuild_products",e.wcbreadcrumbs=g.length,t.post(tmWooAjaxProducts.ajaxurl,e,function(a){if(r.removeClass("loading"),a.success){r.replaceWith(a.data.products);var c=t.Event("tm_wc_products_changed");for(var n in a.data.filters){var d=t("div[data-sidebar="+n+"]"),i=d.children(),s=0;a.data.filters[n].forEach(function(e){!1!==e.content?"undefined"!=typeof i[s]?i[s].id===e.id?(t(i[s]).replaceWith(e.content),c.widgets_updated=!0,s++):""!==e.content&&(t(i[s]).before(e.content),c.widgets_updated=!0,i=d.children(),s++):(t("div[data-sidebar="+n+"]").append(e.content),c.widgets_updated=!0,i=d.children()):s++})}a.data.wcbreadcrumbs&&g.replaceWith(a.data.wcbreadcrumbs),history.pushState&&location.href!==e.pageUrl&&history.pushState(null,null,e.pageUrl),t(document).trigger(c),o()}})},t.tmWcOrderingHandler=function(e){var r=t(e.currentTarget);if(!tmWooAjaxProducts.ajaxOrderby&&r.closest("form").hasClass("woocommerce-ordering"))return void r.closest("form").submit();var a,o=location.href,c=r.closest("form"),n=c.serialize(),d=location.search;a=d.length?o.replace(d,"?"+n):o+"?"+n;var i={pageUrl:a,task:"ordering"};t.tmWcProductsAjax(i)},t(document).ready(function(){o()})}(jQuery);