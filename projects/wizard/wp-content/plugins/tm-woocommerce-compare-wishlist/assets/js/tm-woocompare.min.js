!function(o){"use strict";o(document).ready(function(){function e(){o(i).each(function(){var e=o(this);e.on("click",function(a){a.preventDefault();var c=tmWoocompare.ajaxurl,m={action:"tm_woocompare_add_to_list",pid:e.data("id"),nonce:e.data("nonce"),single:e.hasClass("tm-woocompare-button-single")};e.removeClass(r).addClass(n),o.post(c,m,function(a){if(e.removeClass(n),a.success){switch(a.data.action){case"add":o(i+"[data-id="+m.pid+"]").addClass(r).find(".text").text(tmWoocompare.removeText),a.data.comparePageBtn&&e.after(a.data.comparePageBtn);break;case"remove":o(i+"[data-id="+m.pid+"]").removeClass(r).find(".text").text(tmWoocompare.compareText),o(".tm-woocompare-page-button").remove()}m={action:"tm_woocompare_update"},t(null,m)}})})})}function t(e,t){e&&e.preventDefault();var a=tmWoocompare.ajaxurl,c=o("div.tm-woocompare-widget-wrapper"),d=o("div.tm-woocompare-list");t.isComparePage=!!d.length,t.isWidget=!!c.length,("tm_woocompare_update"!==t.action||t.isComparePage||t.isWidget)&&(d.addClass(n),c.addClass(n),o.post(a,t,function(e){d.removeClass(n),c.removeClass(n),e.success&&(t.isComparePage&&(o("div.tm-woocompare-wrapper").html(e.data.compareList),o(document).trigger("enhance.tablesaw")),t.isWidget&&c.html(e.data.widget),"tm_woocompare_empty"===t.action&&(o(i).removeClass(r).find(".text").text(tmWoocompare.compareText),o(".tm-woocompare-page-button").remove()),"tm_woocompare_remove"===t.action&&(o(i+"[data-id="+t.pid+"]").removeClass(r).find(".text").text(tmWoocompare.compareText),o(".tm-woocompare-page-button").remove())),m()}))}function a(e){var a=o(e.currentTarget),c={action:"tm_woocompare_remove",pid:a.data("id"),nonce:a.data("nonce")};t(e,c)}function c(o){var e={action:"tm_woocompare_empty"};t(o,e)}function m(){o(".tm-woocompare-remove").off("click").on("click",function(o){a(o)}),o(".tm-woocompare-empty").off("click").on("click",function(o){c(o)})}var n="loading",r="added in_compare",i="button.tm-woocompare-button";m(),e(),o(document).on("tm_wc_products_changed",function(){m(),e()})})}(jQuery);