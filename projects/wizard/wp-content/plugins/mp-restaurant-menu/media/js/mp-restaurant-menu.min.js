window.MP_RM_Registry=function(){"use strict";function e(e){return"function"==typeof e.getInstance}function t(t,n){if(!e(n))throw new Error('Invalide module "'+t+'". The function "getInstance" is not defined.');a[t]=n}function n(t){for(var n in t)if(t.hasOwnProperty(n)){if(!e(t[n]))throw new Error('Invalide module "'+n+'" inside the collection. The function "getInstance" is not defined.');a[n]=t[n]}}function r(e){delete a[e]}function i(e){var t=a[e];if(!t)throw new Error('The module "'+e+'" has not been registered or it was unregistered.');if("function"!=typeof t.getInstance)throw new Error('The module "'+e+'" can not be instantiated. The function "getInstance" is not defined.');return a[e].getInstance()}var a={};return{register:t,unregister:r,_get:i,MP_RM_RegistryMap:n}}(),MP_RM_Registry.register("MP_RM_Functions",function(e){"use strict";function t(){return{init:function(){},wpAjax:function(e,t,n){e.mprm_action=e.action,delete e.action,wp.ajax.send("route_url",{success:function(e){!_.isUndefined(n)&&_.isFunction(n)&&t(e)},error:function(e){!_.isUndefined(n)&&_.isFunction(n)?n(e):console.log(e)},data:e})},getParameterByName:function(e,t){var n,r=[];if(e){for(var i=e.slice(e.indexOf("?")+1).split("&"),a=0;a<i.length;a++)n=i[a].split("="),r.push(n[0]),r[n[0]]=n[1];return"undefined"!=typeof t?r[t]:r}return!1},stringToBoolean:function(e){switch(e.toLowerCase().trim()){case"true":case"yes":case"1":return!0;case"false":case"no":case"0":case null:return!1;default:return Boolean(e)}},callModal:function(t,n,r){t=_.isEmpty(t)?o:t;var i=e(window).outerHeight()-60,a=e(window).outerWidth()-60,o=wp.html.string({tag:"span",attrs:{"class":"spinner is-active"},content:""}),m={content:t,closeOnEsc:!0,animation:{open:"zoomIn",close:"zoomOut"},width:a,height:i,closeButton:"box",addClass:"mprm-modal mprm-restaurant",onOpen:function(){var t=e("#"+this.id);n.call(this,t)},onClose:function(){e("#"+this.id).remove()}};_.isUndefined(r)||e.extend(m,r);var s=new jBox("Modal",m);s.open()},inArray:function(t,n){var r=[],i=e.inArray(n,t);return i>=0&&r.push(t[i]),r},validateForm:function(t){if(t){var n=e("#"+t),r=document.getElementById(t);return"function"==typeof r.checkValidity&&!1===r.checkValidity()?(n.find(":invalid").addClass("mprm-form-error"),n.find("input").not(":submit, :reset, :image, [disabled], :hidden").each(function(){this.validity.valid||e(this).focus()}),e("input",n).off("keypress").on("keypress",function(t){var n=e(this).attr("type");/date|email|month|number|search|tel|text|time|url|week/.test(n)&&13===t.keyCode||e(this).removeClass("mprm-form-error")}),e("select",n).off("change").on("change",function(){e(this).removeClass("mprm-form-error")}),!1):!0}return!1}}}var n;return{getInstance:function(){return n||(n=t()),n}}}(jQuery)),MP_RM_Registry.register("HtmlBuilder",function(e){"use strict";function t(){return{_singleHtmlTag:{tag:"div",attrs:{id:356,"class":"item","data-selector":"some-button"},content:"<%= data-key %>"},_htmlStructure:{tag:"div",attrs:{id:356,"class":"item","data-selector":"some-button"},content:{tag:"div",attrs:{"class":"title"},content:"<%= data-key %>"}},_htmlStructureWithArray:{tag:"div",attrs:{id:356,"class":"item","data-selector":"some-button"},content:[{tag:"div",attrs:{"class":"title"},content:"<%= data-key %>"},{tag:"span",attrs:{"class":"date"},content:"<%= data-key %>"}]},generateHTML:function(t){var r,i="";if(_.isObject(t)){var a=document.createElement(t.tag);_.isUndefined(t.attrs)||e.each(t.attrs,function(e,t){a.setAttribute(e,t)}),_.isArray(t.content)?(e.each(t.content,function(e,t){i+=n.generateHTML(t)}),e(a).html(i)):_.isObject(t.content)?(i=n.generateHTML(t.content),e(a).html(i)):_.isUndefined(t.content)?e(a).html(""):e(a).html(t.content),r=e(a).get(0).outerHTML}else r=_.isString(t)?t:!1;return r},getHtml:function(t,r){if(_.isUndefined(t))return!1;var i=!1;if(_.isUndefined(r)&&(_.isArray(t)?(i="",e.each(t,function(e,t){i+=n.generateHTML(t)})):i=n.generateHTML(t)),_.isObject(r)){var a=_.template(i);i=a(r)}return i}}}var n;return{getInstance:function(){return n||(n=t()),n}}}(jQuery)),MP_RM_Registry.register("Menu-Shop",function(e){"use strict";function t(){return{initPreloader:function(e,t){"show"===e?(t.find(".mprm-add-menu-item .mprm-add-to-cart").addClass("mprm-preloader-color"),t.find(".mprm-add-menu-item .mprm-container-preloader .mprm-floating-circle-wrapper").removeClass("mprm-hidden")):(t.find(".mprm-add-menu-item .mprm-container-preloader .mprm-floating-circle-wrapper").addClass("mprm-hidden"),t.find(".mprm-add-menu-item .mprm-add-to-cart").removeClass("mprm-preloader-color"))},addToCart:function(){e(".mprm-add-to-cart.mprm-has-js").on("click",function(t){t.preventDefault();var r=e(this),i=r.closest("form"),a=i.serializeArray(),o=i.parents(".mprm_menu_item_buy_button").find("> .mprm-notice"),m=i.parents(".mprm_menu_item_buy_button");e(".mprm_menu_item_buy_button").find("> .mprm-notice").addClass("mprm-hidden"),a.push({name:"is_ajax",value:!0}),e(".widget_mprm_cart_widget").length&&a.push({name:"cart",value:!0}),n.initPreloader("show",m),MP_RM_Registry._get("MP_RM_Functions").wpAjax(a,function(t){o.addClass("mprm-notice-success"),o.removeClass("mprm-hidden mprm-notice-error"),e(".widget_mprm_cart_widget .mprm-cart-content").html(t.cart),n.initPreloader("hide",m),t.redirect?window.location=t.redirect:(e(".mprm-cart-added-alert",i).fadeIn(),setTimeout(function(){e(".mprm-cart-added-alert",i).fadeOut()},3e3))},function(e){var t=i.parents(".mprm_menu_item_buy_button").find(".mprm-notice");t.addClass("mprm-notice-error").removeClass("mprm-hidden"),n.initPreloader("hide",m),console.warn("Some error!!!"),console.warn(e)})})},changeGateway:function(){e("input[name=payment-mode]","#mprm_purchase_form").on("change",function(){e("#mprm_purchase_form_wrap").html(""),n.loadGateway()})},loadGateway:function(){var t=e("input[name=payment-mode]:checked","#mprm_purchase_form").val();if(t){var r=[{name:"controller",value:"cart"},{name:"mprm_action",value:"load_gateway"},{name:"payment-mode",value:t}];e(".mprm-cart-ajax").show(),MP_RM_Registry._get("MP_RM_Functions").wpAjax(r,function(t){e(".mprm-no-js:not(.mprm-add-to-cart)").hide(),e("#mprm_purchase_form_wrap").html(t.html),n.showTerms()},function(e){console.warn("Some error!!!"),console.warn(e)})}},update_item_quantities:function(){e(".mprm-item-quantity").on("change",function(){var t=this;clearTimeout(r),r=setTimeout(function(){var n=e(t),r=n.val(),i=n.data("key"),a=n.closest(".mprm_cart_item").data("menu-item-id"),o=n.parent().find('input[name="mprm-cart-menu-item-'+i+'-options"]').val(),m={action:"update_cart_item_quantity",controller:"cart",quantity:r,menu_item_id:a,options:o,position:i};MP_RM_Registry._get("MP_RM_Functions").wpAjax(m,function(t){e(".mprm_cart_subtotal_amount").each(function(){var n=e(this);n.text(t.subtotal),n.attr("data-subtotal",t.subtotal),n.attr("data-total",t.subtotal)}),e(".mprm_cart_tax_amount").each(function(){e(this).text(t.taxes)}),e(".mprm_cart_amount").each(function(){var n=e(this);n.text(t.total),n.attr("data-subtotal",t.total),n.attr("data-total",t.total)})},function(e){console.warn("Some error!!!"),console.warn(e)})},1e3)})},purchaseForm:function(){e(document).on("click","#mprm_purchase_form #mprm_purchase_submit input[type=submit]",function(t){var n=e(this).parents("form");if(n.length&&!n.hasClass("mprm-no-js")){var r=document.getElementById("mprm_purchase_form");if(!MP_RM_Registry._get("MP_RM_Functions").validateForm("mprm_purchase_form"))return;t.preventDefault(),e(this).after('<span class="mprm-cart-ajax"><i class="mprm-icon-spinner mprm-icon-spin"></i></span>');var i=e(r).serializeArray();e.each(i,function(e,t){t&&"mprm_action"===t.name&&"gateway_select"===t.value&&i.splice(e,1)}),e(".mprm-cart-ajax").show(),e(".mprm-errors").remove(),MP_RM_Registry._get("MP_RM_Functions").wpAjax(i,function(t){t.errors?e("#mprm_final_total_wrap").before(t.errors):e("#mprm_purchase_form").submit()},function(t){t.error&&e("#mprm_final_total_wrap").before(t.errors),e(".mprm-cart-ajax").remove(),console.warn("Some error!!!"),console.warn(t)})}})},showTerms:function(){e("#mprm_show_terms").find(".mprm_terms_links").on("click",function(t){t.preventDefault(),e(this).parents("#mprm_show_terms").find(".mprm_terms_links").toggle(),e("#mprm_terms").toggle()})},get_login:function(){e("#mprm_checkout_form_wrap").on("click",".mprm_checkout_register_login",function(t){t.preventDefault();var n=e(this),r={action:"get_login",controller:"customer"};MP_RM_Registry._get("MP_RM_Functions").wpAjax(r,function(e){n.parent().html(e.html)},function(e){console.warn("Some error!!!"),console.warn(e)})})},loginAjax:function(){e("#mprm_checkout_form_wrap").on("click",'#mprm_login_submit,[name="mprm_login_submit"]',function(t){t.preventDefault(),e(".mprm-errors").remove();var n={action:"login_ajax",controller:"customer",nonce:e('[name="mprm_login_nonce"]').val(),redirect:e('[name="redirect"]').val(),pass:e('[name="mprm_user_pass"]').val(),login:e('[name="mprm_user_login"]').val()};MP_RM_Registry._get("MP_RM_Functions").wpAjax(n,function(e){e.redirect?window.location=e.redirect_url:window.location.reload()},function(t){t.data.html?e("#mprm_checkout_form_wrap").find(".mprm-login-fields").after(t.data.html):(console.warn("Some error!!!"),console.warn(t))})})}}}var n,r;return{getInstance:function(){return n||(n=t()),n}}}(jQuery)),MP_RM_Registry.register("Order",function(e){"use strict";function t(){return{init:function(){n.hideElementOrder(),n.addComment(),n.removeComment(),n.addCustomer(),n.removeMenuItem(),n.addMenuItem(),n.recalculate_total(),n.changeOrderBaseCountry(),n.changeCustomer()},changeOrderBaseCountry:function(){e("[name='mprm_settings[base_state]'] option").length<1&&e("[name='mprm_settings[base_state]']").parents("tr").hide(),e("select.mprm-country-list").on("change",function(){var t={action:"get_state_list",controller:"settings",country:e(this).val()},n=e(this).parents(".mprm-columns.mprm-four"),r=n.find("select.mprm-country-state");MP_RM_Registry._get("MP_RM_Functions").wpAjax(t,function(t){r.parents("#mprm-order-address-state-wrap").hide(),e.isEmptyObject(t)?r.parents("#mprm-order-address-state-wrap").hide():(r.find("option").remove(),e.each(t,function(t,n){r.append(e("<option>").text(n).attr("value",t))}),r.trigger("chosen:updated"),r.parents("#mprm-order-address-state-wrap").show())},function(e){console.warn("Some error!!!"),console.warn(e)})})},addComment:function(){e("#mprm-add-order-note").on("click",function(t){t.preventDefault();var r={action:"add_comment",controller:"order",order_id:e(this).attr("data-order-id"),noteText:e("#mprm-order-note").val()};MP_RM_Registry._get("MP_RM_Functions").wpAjax(r,function(t){e(".mprm-no-order-notes").hide(),e("#mprm-order-notes-inner").append(t.html),e("#mprm-order-note").val(""),n.removeComment()},function(e){console.warn("Some error!!!"),console.warn(e)})})},addMenuItem:function(){e('[name="mprm-order-menu-item-select"]').on("change",function(){var t={action:"get_price",controller:"menu_item",menu_item:e(this).val()};MP_RM_Registry._get("MP_RM_Functions").wpAjax(t,function(t){e('[name="mprm-order-menu-item-amount"]').val(t.price)},function(e){console.warn("Some error!!!"),console.warn(e)})}),e("#mprm-order-add-menu-item").on("click",function(t){t.preventDefault();var n=e('[name="mprm-order-menu-item-select"]'),r=e("#mprm-order-menu-item-quantity"),i=e('[name="mprm-order-menu-item-amount"]'),a=n.val(),o=e('[name="mprm-order-menu-item-select"] option:selected').text(),m=r.val(),s=i.val(),c=0,d=!1,u=0;if(1>a)return!1;if(s||(s=0),s=parseFloat(s),isNaN(s))return alert(mprm_admin_vars.numeric_item_price),!1;var l=s;if("1"===mprm_admin_vars.quantities_enabled){if(isNaN(parseInt(m)))return alert(mprm_admin_vars.numeric_quantity),!1;s*=m}var p=(s/m).toFixed(mprm_admin_vars.currency_decimals)+mprm_admin_vars.currency_sign;if("before"===mprm_admin_vars.currency_pos&&(p=mprm_admin_vars.currency_sign+(s/m).toFixed(mprm_admin_vars.currency_decimals)),MP_RM_Registry._get("MP_RM_Functions").stringToBoolean(mprm_admin_vars.enable_taxes)&&mprm_admin_vars.rate>1){var _=mprm_admin_vars.rate/100;if(isNaN(_))return alert(mprm_admin_vars.numeric_tax),!1;u=s*_,s=parseFloat(s)+parseFloat(u)}s=s.toFixed(mprm_admin_vars.currency_decimals);var f=s+mprm_admin_vars.currency_sign;"before"===mprm_admin_vars.currency_pos&&(f=mprm_admin_vars.currency_sign+s),d&&(o=o+" - "+d);var g=e(".mprm-row.item").length,h=e("#mprm-purchased-wrapper").find(".mprm-row.item:last").clone();h.find(".menu_item span").html('<a href="post.php?post='+a+'&action=edit"></a>'),h.find(".item span a").text(o),h.find(".price-text").text(f),h.find(".item-quantity").text(m),h.find(".item-price").text(p),h.find("input.mprm-order-detail-id").val(a),h.find("input.mprm-order-detail-price-id").val(c),h.find("input.mprm-order-detail-item-price").val(l),h.find("input.mprm-order-detail-amount").val(s),h.find("input.mprm-order-detail-tax").val(u),h.find("input.mprm-order-detail-quantity").val(m),h.find("input.mprm-order-detail-has-log").val(0),h.find("input").each(function(){var t=e(this).attr("name");t=t.replace(/\[(\d+)\]/,"["+parseInt(g)+"]"),e(this).attr("name",t).attr("id",t)}),e("#mprm-payment-menu-items-changed").val(1),e(h).insertAfter("#mprm-purchased-wrapper .mprm-row.item:last"),e(".mprm-order-recalc-totals").show()})},recalculate_total:function(){e("#mprm-order-recalc-total").on("click",function(t){t.preventDefault();var n=0,r=e("#mprm-purchased-wrapper").find(".mprm-row.item .mprm-order-detail-amount"),i=0;r.length&&r.each(function(){n+=parseFloat(e(this).val())}),e(".mprm-order-fees").length&&e(".mprm-order-fees span.fee-amount").each(function(){n+=parseFloat(e(this).data("fee"))}),e(".mprm-order-detail-tax").length&&e(".mprm-order-detail-tax","#mprm-purchased-wrapper").each(function(){i+=parseFloat(e(this).val())}),e('input[name="mprm-order-total"]').val(n.toFixed(mprm_admin_vars.currency_decimals)),e('input[name="mprm-order-tax"]').val(i.toFixed(mprm_admin_vars.currency_decimals)),e(".mprm-order-recalc-totals").hide()})},removeMenuItem:function(){e(".mprm-order-remove-menu-item.mprm-delete").on("click",function(t){t.preventDefault();var n=e(document.body).find("#mprm-purchased-wrapper > .mprm-row").length;if(1===n)return alert(mprm_admin_vars.one_menu_item_min),!1;if(confirm(mprm_admin_vars.delete_payment_menu_item)){var r=e(this).data("key"),i=e('input[name="mprm-order-removed"]'),a=e('input[name="mprm-order-details['+r+'][id]"]').val(),o=e('input[name="mprm-order-details['+r+'][price_id]"]').val(),m=e('input[name="mprm-order-details['+r+'][quantity]"]').val(),s=e('input[name="mprm-order-details['+r+'][amount]"]').val(),c=i.val();c=e.parseJSON(c),c.length<1&&(c={}),c[r]=[{id:a,price_id:o,quantity:m,amount:s,cart_index:r}],i.val(JSON.stringify(c)),e(this).parents(".mprm-row").remove(),e("#mprm-order-menu-items-changed").val(1),e(".mprm-order-recalc-totals").show()}return!1})},changeCustomer:function(){e('[name="customer-id"]').on("change",function(){var t={action:"get_customer_information",controller:"customer",customer_id:e(this).val()};MP_RM_Registry._get("MP_RM_Functions").wpAjax(t,function(t){e(".mprm-customer-information").html(t.customer_information)},function(e){console.warn("Some error!!!"),console.warn(e)})})},addCustomer:function(){var t=e(".customer-info.mprm-row"),n=e(".new-customer.mprm-row"),r=e('[name="mprm-new-customer"]');e(".mprm-new-customer").on("click",function(){t.hide(),n.show(),r.val(1)}),e(".mprm-new-customer-cancel").on("click",function(){t.show(),n.hide(),r.val(0)}),e(".mprm-new-customer-save").on("click",function(r){r.preventDefault();var i={action:"add_customer",controller:"customer",name:e('[name="mprm-new-customer-name"]').val(),email:e('[name="mprm-new-customer-email"]').val(),phone:e('[name="mprm-new-phone-number"]').val()};MP_RM_Registry._get("MP_RM_Functions").wpAjax(i,function(r){t.show(),n.hide(),e('[name="customer-id"]').replaceWith(r.html),e(".mprm-customer-information").html(r.customer_information)},function(e){t.show(),n.hide(),console.warn("Some error!!!"),console.warn(e)})})},initChosen:function(){var t=e(".mprm-select-chosen");t.length&&e.each(t,function(){var t=e(this),n="undefined"!=typeof t.attr("data-text_single")?t.attr("data-text_single"):mprm_admin_vars.one_option,r="undefined"!=typeof t.attr("data-text_multiple")?t.attr("data-text_multiple"):mprm_admin_vars.one_or_more_option;t.chosen({inherit_select_classes:!0,placeholder_text_single:n,placeholder_text_multiple:r})})},removeComment:function(){e(document).on("click.remove_order_note",".mprm-delete-order-note",function(t){t.preventDefault();var n=e(this).attr("data-note-id"),r={action:"remove_comment",controller:"order",order_id:e(this).attr("data-order-id"),note_id:n};MP_RM_Registry._get("MP_RM_Functions").wpAjax(r,function(){e("#mprm-payment-note-"+n).remove(),e(".mprm-payment-note").length<1&&e(".mprm-no-order-notes").show()},function(e){console.warn("Some error!!!"),console.warn(e)})})},hideElementOrder:function(){var t=e("#post_status");e("#submitdiv").hide(),e("#order-log").hide(),e("#titlewrap").parents("#post-body-content").hide(),e("#commentstatusdiv").parent().hide(),t.find("option").remove(),e('select[name="mprm-order-status"]').find("option").clone().appendTo(t)}}}var n;return{getInstance:function(){return n||(n=t()),n}}}(jQuery)),MP_RM_Registry.register("Menu-Settings",function(e){"use strict";function t(){return{init:function(){e("#rm_settings").on("submit",function(){var t=e(this).serializeArray();return e("#setting-error-settings_updated:visible").remove(),n.saveSettings(t,function(){var t=e("#setting-error-settings_updated").clone();t.removeClass("hidden"),e(".wrap #settings-title").after(t),e(".notice-dismiss").on("click",function(){e(this).parent().remove()})}),!1}),n.changeBaseCountry(),n.settingsUpload()},saveSettings:function(e,t){MP_RM_Registry._get("MP_RM_Functions").wpAjax(e,function(e){!_.isUndefined(t)&&_.isFunction(t)&&t(e)},function(e){console.warn("Some error!!!"),console.warn(e)})},delete_checked:function(){e("#mprm-customer-delete-confirm").change(function(){var t=e("#mprm-customer-delete-records"),n=e("#mprm-delete-customer");e(this).prop("checked")?(t.attr("disabled",!1),n.attr("disabled",!1)):(t.attr("disabled",!0),t.prop("checked",!1),n.attr("disabled",!0))})},settingsUpload:function(){if("undefined"==typeof wp||"1"!==mprm_admin_vars.new_media_ui){var t=e(".mprm_settings_upload_button");t.length>0&&(window.formfield="",e(document.body).on("click",t,function(t){t.preventDefault(),window.formfield=e(this).parent().prev(),window.tbframe_interval=setInterval(function(){jQuery("#TB_iframeContent").contents().find(".savesend .button").val(mprm_admin_vars.use_this_file).end().find("#insert-gallery, .wp-post-thumbnail").hide()},2e3),tb_show(mprm_admin_vars.add_new_menu_item,"media-upload.php?TB_iframe=true")}),window.mprm_send_to_editor=window.send_to_editor,window.send_to_editor=function(t){if(window.formfield){var n=e("a","<div>"+t+"</div>").attr("href");window.formfield.val(n),window.clearInterval(window.tbframe_interval),tb_remove()}else window.mprm_send_to_editor(t);window.send_to_editor=window.mprm_send_to_editor,window.formfield="",window.imagefield=!1})}else{var n;window.formfield="",e(document.body).on("click",".mprm_settings_upload_button",function(t){t.preventDefault();var r=e(this);return window.formfield=e(this).parent().prev(),n?void n.open():(n=wp.media.frames.file_frame=wp.media({frame:"post",state:"insert",title:r.data("uploader_title"),button:{text:r.data("uploader_button_text")},multiple:!1}),n.on("menu:render:default",function(e){var t={};e.unset("library-separator"),e.unset("gallery"),e.unset("featured-image"),e.unset("embed"),e.set(t)}),n.on("insert",function(){var e=n.state().get("selection");e.each(function(e){e=e.toJSON(),window.formfield.val(e.url)})}),void n.open())}),window.formfield=""}},changeBaseCountry:function(){e("[name='mprm_settings[base_state]'] option").length<1&&e("[name='mprm_settings[base_state]']").parents("tr").hide(),e("[name='mprm_settings[base_country]']").on("change",function(){var t={action:"get_state_list",controller:"settings",country:e(this).val()},n=e(this).closest("tr"),r=n.next().find("select");MP_RM_Registry._get("MP_RM_Functions").wpAjax(t,function(t){e.isEmptyObject(t)?n.next().hide():(n.next().show(),r.remove("option"),e.each(t,function(t,n){r.append(e("<option>").text(n).attr("value",t))}))},function(e){console.warn("Some error!!!"),console.warn(e)})})}}}var n;return{getInstance:function(){return n||(n=t()),n}}}(jQuery)),MP_RM_Registry.register("Menu-Item",function(e){"use strict";function t(){return{imgIds:[],init:function(){n.imagesInit(),e("a.mp_menu_gallery").on("click",function(){n.openMediaWindow()})},imagesInit:function(){e(document).on("click.mprm_delete_img",".mp_menu_images a.mprm-delete",function(){return e(this).parents("li.mprm-image").remove(),n.refreshImages(),!1}),n.refreshImages(),e("#mprm-menu-item-gallery").find(".mp_menu_images").sortable({items:"li.mprm-image",cursor:"move",scrollSensitivity:40,forcePlaceholderSize:!0,forceHelperSize:!1,helper:"clone",opacity:.65,placeholder:"mp-metabox-sortable-placeholder",start:function(e,t){t.item.css("background-color","#f6f6f6")},stop:function(e,t){t.item.removeAttr("style")},update:function(){n.refreshImages()}})},openMediaWindow:function(){if(void 0===this.window){this.window=wp.media({title:mprm_admin_vars.insert_media,library:{type:"image"},multiple:!0,button:{text:mprm_admin_vars.insert}});var t=this;this.window.on("select",function(){var r=t.window.state().get("selection").toJSON();e("#mprm-menu-item-gallery").find(".mp_menu_images").append(n._buildImages(r)),n.imagesInit()})}return this.window.open(),!1},refreshImages:function(){var t=[],n=e("#mprm-menu-item-gallery");n.find(".mp_menu_images li.mprm-image").each(function(n,r){t[n]=e(r).attr("data-attachment_id"),e(r).attr("data-key",n)}),n.find(' input[name="mp_menu_gallery"]').val(t.join(","))},_buildImages:function(t){var n=[];e.each(t,function(e,t){n.push({tag:"li",attrs:{"class":"mprm-image","data-attachment_id":t.id,new_image:1},content:[{tag:"img",attrs:{src:t.sizes.thumbnail.url}},{tag:"ul",attrs:{"class":"mprm-actions"},content:[{tag:"li",content:[{tag:"a",attrs:{"class":"mprm-delete",title:mprm_admin_vars.delete_img,href:"#"},content:mprm_admin_vars["delete"]}]}]}]})});try{return MP_RM_Registry._get("HtmlBuilder").getHtml(n)}catch(r){console.log(r)}},quickEdit:function(){e(document).on("click","#the-list .editinline",function(){var t=e(this).closest("tr"),n=t.attr("id").replace(/\D/gi,""),r=t.find(".mprm-data-price").text(),i=t.find(".mprm-data-sku").text(),a=t.find(".mprm-data-calories").text(),o=t.find(".mprm-data-cholesterol").text(),m=t.find(".mprm-data-fiber").text(),s=t.find(".mprm-data-sodium").text(),c=t.find(".mprm-data-carbohydrates").text(),d=t.find(".mprm-data-fat").text(),u=t.find(".mprm-data-protein").text(),l=t.find(".mprm-data-bulk").text(),p=t.find(".mprm-data-size").text(),_=t.find(".mprm-data-weight").text(),f=e("#edit-"+n);f.find('.inline-price [name="price"]').val(r),f.find('.inline-sku [name="sku"]').val(i),f.find('[name="nutritional[calories][val]"]').val(a),f.find('[name="nutritional[cholesterol][val]"]').val(o),f.find('[name="nutritional[fiber][val]"]').val(m),f.find('[name="nutritional[sodium][val]"]').val(s),f.find('[name="nutritional[carbohydrates][val]"]').val(c),f.find('[name="nutritional[fat][val]"]').val(d),f.find('[name="nutritional[protein][val]"]').val(u),f.find('[name="attributes[bulk][val]"]').val(l),f.find('[name="attributes[size][val]"]').val(p),f.find('[name="attributes[weight][val]"]').val(_)})}}}var n;return{getInstance:function(){return n||(n=t()),n}}}(jQuery)),MP_RM_Registry.register("Menu-Category",function(e){"use strict";function t(){return{init:function(){e("#IconPicker").fontIconPicker({source:e.fnt_icons_categorized,emptyIcon:!0,hasSearch:!0}).on("change",function(){}),e(".remove_icon_button").on("click",function(){e(this).siblings(".mprm_icon_p").find("input").attr({value:""})}),e(".upload_image_button").on("click",function(){return n.openUploadWindow(),!1}),e(".remove_image_button").on("click",function(){var t=e("#menu_category_thumbnail");return t.find("img").attr("src",t.find("img").attr("data-placeholder")),e("#menu_category_thumbnail_id").val(""),e(".remove_image_button").hide(),!1})},openUploadWindow:function(){if(void 0===this.window){this.window=wp.media.frames.menu_itemable_file=wp.media({title:mprm_admin_vars.choose_image,button:{text:mprm_admin_vars.use_image},multiple:!1});var t=this;this.window.on("select",function(){var n=t.window.state().get("selection").first().toJSON();e("#menu_category_thumbnail_id").val(n.id),e("#menu_category_thumbnail").find("img").attr("src",n.sizes.thumbnail.url),e(".remove_image_button").show()})}this.window.open()}}}var n;return{getInstance:function(){return n||(n=t()),n}}}(jQuery)),MP_RM_Registry.register("Theme",function(e){"use strict";function t(){return{init:function(){"undefined"!=typeof e.magnificPopup&&e(".type-mp_menu_item .gallery-item,.type-mp_menu_item .mprm-item-gallery").magnificPopup({delegate:"a",type:"image",tLoading:"Loading image #%curr%...",mainClass:"mfp-img-mobile",gallery:{enabled:!0,navigateByImgClick:!0,preload:[0,1]},image:{tError:'<a href="%url%">The image #%curr%</a> could not be loaded.',titleSrc:function(e){return e.el.attr("title")}},zoom:{enabled:!0,duration:300}})},viewParams:function(e,t){switch(t){case"simple-list":e.find(".mprm-widget-feat_img").addClass("hidden"),e.find(".mprm-widget-buy").addClass("hidden"),e.find('select.mprm-widget-categ_name option[value="with_img"]').change("only_text").addClass("hidden"),e.find(".mprm-widget-price_pos").removeClass("hidden");break;default:e.find(".mprm-widget-feat_img").removeClass("hidden"),e.find(".mprm-widget-buy").removeClass("hidden"),e.find('select.mprm-widget-categ_name option[value="with_img"]').change("only_text").removeClass("hidden"),e.find(".mprm-widget-price_pos").addClass("hidden")}},customizeWidget:function(){e.each(e(".mprm-widget-view"),function(){var t=e(this).parents(".widget-content"),r=e(this).val();n.viewParams(t,r)}),e(document.body).on("change",".mprm-widget-view",function(){var t=e(this).parents(".widget-content"),r=e(this).val();n.viewParams(t,r)})}}}var n;return{getInstance:function(){return n||(n=t()),n}}}(jQuery)),function(e){"use strict";e(document).ready(function(){"mp_menu_item"===e(window.post_type).val()&&MP_RM_Registry._get("Menu-Item").init(),"edit-mp_menu_item"===window.pagenow&&MP_RM_Registry._get("Menu-Item").quickEdit(),"restaurant-menu_page_mprm-settings"===window.pagenow&&MP_RM_Registry._get("Menu-Settings").init(),"restaurant-menu_page_mprm-customers"===window.pagenow&&MP_RM_Registry._get("Menu-Settings").delete_checked(),"edit-mp_menu_category"===window.pagenow&&MP_RM_Registry._get("Menu-Category").init(),"mprm_order"===e(window.post_type).val()&&MP_RM_Registry._get("Order").init(),e(".mprm-select-chosen").length&&MP_RM_Registry._get("Order").initChosen(),e(".mprm-add-to-cart").length&&MP_RM_Registry._get("Menu-Shop").addToCart(),e("#mprm_checkout_wrap").length&&MP_RM_Registry._get("Menu-Shop").purchaseForm(),e("#mprm_purchase_form").length&&(MP_RM_Registry._get("Menu-Shop").loadGateway(),MP_RM_Registry._get("Menu-Shop").changeGateway(),MP_RM_Registry._get("Menu-Shop").update_item_quantities(),MP_RM_Registry._get("Menu-Shop").showTerms(),MP_RM_Registry._get("Menu-Shop").get_login(),MP_RM_Registry._get("Menu-Shop").loginAjax()),e(".mprm-widget-view").length&&MP_RM_Registry._get("Theme").customizeWidget(),(e(".gallery-item").length||e(".mprm-item-gallery").length)&&MP_RM_Registry._get("Theme").init()})}(jQuery);
