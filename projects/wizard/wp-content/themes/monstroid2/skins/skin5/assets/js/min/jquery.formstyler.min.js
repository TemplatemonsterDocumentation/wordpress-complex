!function(a){"function"==typeof define&&define.amd?define(["jquery"],a):"object"==typeof exports?module.exports=a(require("jquery")):a(jQuery)}(function(a){"use strict";function d(b,d){this.element=b,this.options=a.extend({},c,d),this.init()}function e(c){if(!a(c.target).parents().hasClass("jq-selectbox")&&"OPTION"!=c.target.nodeName&&a("div.jq-selectbox.opened").length){var d=a("div.jq-selectbox.opened"),e=a("div.jq-selectbox__search input",d),f=a("div.jq-selectbox__dropdown",d),g=d.find("select").data("_"+b).options;g.onSelectClosed.call(d),e.length&&e.val("").keyup(),f.hide().find("li.sel").addClass("selected"),d.removeClass("focused opened dropup dropdown"),d.parents("p").removeClass("active")}}var b="styler",c={idSuffix:"-styler",filePlaceholder:"",fileBrowse:"",fileNumber:"",selectPlaceholder:"",selectSearch:!1,selectSearchLimit:10,selectSearchNotFound:"",selectSearchPlaceholder:"",selectVisibleOptions:0,singleSelectzIndex:"100",selectSmartPositioning:!0,onSelectOpened:function(){},onSelectClosed:function(){},onFormStyled:function(){}};d.prototype={init:function(){function g(){void 0!==b.attr("id")&&""!==b.attr("id")&&(this.id=b.attr("id")+c.idSuffix),this.title=b.attr("title"),this.classes=b.attr("class"),this.data=b.data()}var b=a(this.element),c=this.options,d=!(!navigator.userAgent.match(/(iPad|iPhone|iPod)/i)||navigator.userAgent.match(/(Windows\sPhone)/i)),f=!(!navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/(Windows\sPhone)/i));if(b.is("select")){var h=function(){function h(b){b.off("mousewheel DOMMouseScroll").on("mousewheel DOMMouseScroll",function(b){var c=null;"mousewheel"==b.type?c=b.originalEvent.wheelDelta*-1:"DOMMouseScroll"==b.type&&(c=40*b.originalEvent.detail),c&&(b.stopPropagation(),b.preventDefault(),a(this).scrollTop(c+a(this).scrollTop()))})}function k(){for(var a=0;a<i.length;a++){var b=i.eq(a),d="",e="",f="",g="",h="",k="",l="",m="",n="",o="disabled",p="selected sel disabled";b.prop("selected")&&(e="selected sel"),b.is(":disabled")&&(e=o),b.is(":selected:disabled")&&(e=p),void 0!==b.attr("id")&&""!==b.attr("id")&&(g=' id="'+b.attr("id")+c.idSuffix+'"'),void 0!==b.attr("title")&&""!==i.attr("title")&&(h=' title="'+b.attr("title")+'"'),void 0!==b.attr("class")&&(l=" "+b.attr("class"),n=' data-jqfs-class="'+b.attr("class")+'"');var q=b.data();for(var r in q)""!==q[r]&&(k+=" data-"+r+'="'+q[r]+'"');e+l!==""&&(f=' class="'+e+l+'"'),d="<li"+n+k+f+h+g+">"+b.html()+"</li>",b.parent().is("optgroup")&&(void 0!==b.parent().attr("class")&&(m=" "+b.parent().attr("class")),d="<li"+n+k+' class="'+e+l+" option"+m+'"'+h+g+">"+b.html()+"</li>",b.is(":first-child")&&(d='<li class="optgroup'+m+'">'+b.parent().attr("label")+"</li>"+d)),j+=d}}function l(){var f=new g,l="",m=b.data("placeholder"),n=b.data("search"),o=b.data("search-limit"),p=b.data("search-not-found"),q=b[0][0].textContent,r=b.data("z-index"),s=b.data("smart-positioning");void 0===m&&(m=c.selectPlaceholder),void 0!==n&&""!==n||(n=c.selectSearch),void 0!==o&&""!==o||(o=c.selectSearchLimit),void 0!==p&&""!==p||(p=c.selectSearchNotFound),void 0===q&&(q=c.selectSearchPlaceholder),void 0!==r&&""!==r||(r=c.singleSelectzIndex),void 0!==s&&""!==s||(s=c.selectSmartPositioning);var t=a('<div class="jq-selectbox jqselect"><div class="jq-selectbox__select" style="position: relative"><div class="jq-selectbox__select-text"></div><div class="jq-selectbox__trigger"><div class="jq-selectbox__trigger-arrow"></div></div></div></div>').css({display:"inline-block",position:"relative",zIndex:r}).attr({id:f.id,title:f.title}).addClass(f.classes).data(f.data);b.css({margin:0,padding:0}).after(t).prependTo(t);var u=a("div.jq-selectbox__select",t),v=a("div.jq-selectbox__select-text",t),w=i.filter(":selected"),x=t.parents("p");k(),n&&(l='<div class="jq-selectbox__search"><input type="search" autocomplete="off" placeholder="'+q+'"></div><div class="jq-selectbox__not-found">'+p+"</div>");var y=a('<div class="jq-selectbox__dropdown" style="position: absolute">'+l+'<ul class="jq-selectbox__dropdown-ul" style="position: relative; list-style: none; overflow: auto; overflow-x: hidden">'+j+"</ul></div>");t.append(y);var z=a("ul",y),A=a("li",y),B=a("input",y),C=a("div.jq-selectbox__not-found",y).hide();A.length<o&&B.parent().hide(),""===i.first().text()&&i.first().is(":selected")?v.text(q).addClass("placeholder"):v.text(w.text());var D=0,E=0;if(A.css({display:"inline-block"}),A.each(function(){var b=a(this);b.innerWidth()>D&&(D=b.innerWidth(),E=b.width())}),A.css({display:""}),v.is(".placeholder")&&v.width()>D)v.width(v.width());else{var F=t.clone().appendTo("body").width("auto"),G=F.outerWidth();F.remove(),G==t.outerWidth()&&v.width(E)}D>t.width()&&y.width(D),""===i.first().text()&&""!==b.data("placeholder")&&A.first().hide(),b.css({position:"absolute",left:0,top:0,width:"100%",height:"100%",opacity:0});var H=t.outerHeight(!0),I=B.parent().outerHeight(!0),J=z.css("max-height"),K=A.filter(".selected");K.length<1&&A.first().addClass("selected sel"),void 0===A.data("li-height")&&A.data("li-height",A.outerHeight());var L=y.css("top");if("auto"==y.css("left")&&y.css({left:0}),"auto"==y.css("top")&&(y.css({top:H}),L=H),y.hide(),K.length&&(i.first().text()!=w.text()&&t.addClass("changed"),t.data("jqfs-class",K.data("jqfs-class")),t.addClass(K.data("jqfs-class"))),b.is(":disabled"))return t.addClass("disabled"),!1;u.click(function(){if(a("div.jq-selectbox").filter(".opened").length&&c.onSelectClosed.call(a("div.jq-selectbox").filter(".opened")),x.addClass("active"),b.focus(),!d){var e=a(window),f=A.data("li-height"),g=t.offset().top,j=e.height()-H-(g-e.scrollTop()),k=b.data("visible-options");void 0!==k&&""!==k||(k=c.selectVisibleOptions);var l=5*f,m=f*k;k>0&&k<6&&(l=m),0===k&&(m="auto");var n=function(){y.height("auto").css({bottom:"auto",top:L});var a=function(){z.css("max-height",Math.floor((j-20-I)/f)*f)};a(),z.css("max-height",m),"none"!=J&&z.css("max-height",J),j<y.outerHeight()+20&&a()},o=function(){y.height("auto").css({top:"auto",bottom:L});var a=function(){z.css("max-height",Math.floor((g-e.scrollTop()-20-I)/f)*f)};a(),z.css("max-height",m),"none"!=J&&z.css("max-height",J),g-e.scrollTop()-20<y.outerHeight()+20&&a()};s===!0||1===s?j>l+I+20?(n(),t.removeClass("dropup").addClass("dropdown")):(o(),t.removeClass("dropdown").addClass("dropup")):s!==!1&&0!==s||j>l+I+20&&(n(),t.removeClass("dropup").addClass("dropdown")),t.offset().left+y.outerWidth()>e.width()&&y.css({left:"auto",right:0}),a("div.jqselect").css({zIndex:r-1}).removeClass("opened"),t.css({zIndex:r}),y.is(":hidden")?(a("div.jq-selectbox__dropdown:visible").hide(),y.show(),t.addClass("opened focused"),c.onSelectOpened.call(t)):(y.hide(),t.removeClass("opened dropup dropdown"),t.parents("p").removeClass("active"),a("div.jq-selectbox").filter(".opened").length&&c.onSelectClosed.call(t)),B.length&&(B.val("").keyup(),C.hide(),B.keyup(function(){var c=a(this).val();A.each(function(){a(this).html().match(new RegExp(".*?"+c+".*?","i"))?a(this).show():a(this).hide()}),""===i.first().text()&&""!==b.data("placeholder")&&A.first().hide(),A.filter(":visible").length<1?C.show():C.hide()})),A.filter(".selected").length&&(""===b.val()?z.scrollTop(0):(z.innerHeight()/f%2!==0&&(f/=2),z.scrollTop(z.scrollTop()+A.filter(".selected").position().top-z.innerHeight()/2+f))),h(z)}}),A.hover(function(){a(this).siblings().removeClass("selected")});var M=A.filter(".selected").text();A.filter(":not(.disabled):not(.optgroup)").click(function(){b.focus();var d=a(this),e=d.text();if(!d.is(".selected")){var f=d.index();f-=d.prevAll(".optgroup").length,d.addClass("selected sel").siblings().removeClass("selected sel"),i.prop("selected",!1).eq(f).prop("selected",!0),M=e,v.text(e),t.data("jqfs-class")&&t.removeClass(t.data("jqfs-class")),t.data("jqfs-class",d.data("jqfs-class")),t.addClass(d.data("jqfs-class")),b.change()}y.hide(),t.removeClass("opened dropup dropdown"),t.parents("p").removeClass("active"),c.onSelectClosed.call(t)}),y.mouseout(function(){a("li.sel",y).addClass("selected")}),b.on("change.styler",function(){v.text(i.filter(":selected").text()).removeClass("placeholder"),A.removeClass("selected sel").not(".optgroup").eq(b[0].selectedIndex).addClass("selected sel"),i.first().text()!=A.filter(".selected").text()?t.addClass("changed"):t.removeClass("changed")}).on("focus.styler",function(){t.addClass("focused"),a("div.jqselect").not(".focused").removeClass("opened dropup dropdown").find("div.jq-selectbox__dropdown").hide().parents("p").removeClass("active")}).on("blur.styler",function(){t.removeClass("focused")}).on("keydown.styler keyup.styler",function(a){var d=A.data("li-height");""===b.val()?v.text(m).addClass("placeholder"):v.text(i.filter(":selected").text()),A.removeClass("selected sel").not(".optgroup").eq(b[0].selectedIndex).addClass("selected sel"),38!=a.which&&37!=a.which&&33!=a.which&&36!=a.which||(""===b.val()?z.scrollTop(0):z.scrollTop(z.scrollTop()+A.filter(".selected").position().top)),40!=a.which&&39!=a.which&&34!=a.which&&35!=a.which||z.scrollTop(z.scrollTop()+A.filter(".selected").position().top-z.innerHeight()+d),13==a.which&&(a.preventDefault(),y.hide(),t.removeClass("opened dropup dropdown"),c.onSelectClosed.call(t))}).on("keydown.styler",function(a){32==a.which&&(a.preventDefault(),u.click())}),e.registered||(a(document).on("click",e),e.registered=!0)}function m(){var c=new g,d=a('<div class="jq-select-multiple jqselect"></div>').css({display:"inline-block",position:"relative"}).attr({id:c.id,title:c.title}).addClass(c.classes).data(c.data);b.css({margin:0,padding:0}).after(d),k(),d.append("<ul>"+j+"</ul>");var e=a("ul",d).css({position:"relative","overflow-x":"hidden","-webkit-overflow-scrolling":"touch"}),f=a("li",d).attr("unselectable","on"),l=b.attr("size"),m=e.outerHeight(),n=f.outerHeight();void 0!==l&&l>0?e.css({height:n*l}):e.css({height:4*n}),m>d.height()&&(e.css("overflowY","scroll"),h(e),f.filter(".selected").length&&e.scrollTop(e.scrollTop()+f.filter(".selected").position().top)),b.prependTo(d).css({position:"absolute",left:0,top:0,width:"100%",height:"100%",opacity:0}),b.is(":disabled")?(d.addClass("disabled"),i.each(function(){a(this).is(":selected")&&f.eq(a(this).index()).addClass("selected")})):(f.filter(":not(.disabled):not(.optgroup)").click(function(c){b.focus();var d=a(this);if(c.ctrlKey||c.metaKey||d.addClass("selected"),c.shiftKey||d.addClass("first"),c.ctrlKey||c.metaKey||c.shiftKey||d.siblings().removeClass("selected first"),(c.ctrlKey||c.metaKey)&&(d.is(".selected")?d.removeClass("selected first"):d.addClass("selected first"),d.siblings().removeClass("first")),c.shiftKey){var e=!1,g=!1;d.siblings().removeClass("selected").siblings(".first").addClass("selected"),d.prevAll().each(function(){a(this).is(".first")&&(e=!0)}),d.nextAll().each(function(){a(this).is(".first")&&(g=!0)}),e&&d.prevAll().each(function(){return!a(this).is(".selected")&&void a(this).not(".disabled, .optgroup").addClass("selected")}),g&&d.nextAll().each(function(){return!a(this).is(".selected")&&void a(this).not(".disabled, .optgroup").addClass("selected")}),1==f.filter(".selected").length&&d.addClass("first")}i.prop("selected",!1),f.filter(".selected").each(function(){var b=a(this),c=b.index();b.is(".option")&&(c-=b.prevAll(".optgroup").length),i.eq(c).prop("selected",!0)}),b.change()}),i.each(function(b){a(this).data("optionIndex",b)}),b.on("change.styler",function(){f.removeClass("selected");var b=[];i.filter(":selected").each(function(){b.push(a(this).data("optionIndex"))}),f.not(".optgroup").filter(function(c){return a.inArray(c,b)>-1}).addClass("selected")}).on("focus.styler",function(){d.addClass("focused")}).on("blur.styler",function(){d.removeClass("focused")}),m>d.height()&&b.on("keydown.styler",function(a){38!=a.which&&37!=a.which&&33!=a.which||e.scrollTop(e.scrollTop()+f.filter(".selected").position().top-n),40!=a.which&&39!=a.which&&34!=a.which||e.scrollTop(e.scrollTop()+f.filter(".selected:last").position().top-e.innerHeight()+2*n)}))}var i=a("option",b),j="";if(b.is("[multiple]")){if(f||d)return;m()}else l()};h(),b.on("refresh",function(){b.off(".styler").parent().before(b).remove(),h()})}else b.is(":reset")&&b.on("click",function(){setTimeout(function(){b.closest("form").find("input, select").trigger("refresh")},1)})},destroy:function(){var c=a(this.element);c.is(":checkbox")||c.is(":radio")?(c.removeData("_"+b).off(".styler refresh").removeAttr("style").parent().before(c).remove(),c.closest("label").add('label[for="'+c.attr("id")+'"]').off(".styler")):c.is('input[type="number"]')?c.removeData("_"+b).off(".styler refresh").closest(".jq-number").before(c).remove():(c.is(":file")||c.is("select"))&&c.removeData("_"+b).off(".styler refresh").removeAttr("style").parent().before(c).remove()}},a.fn[b]=function(c){var e=arguments;if(void 0===c||"object"==typeof c)return this.each(function(){a.data(this,"_"+b)||a.data(this,"_"+b,new d(this,c))}).promise().done(function(){var c=a(this[0]).data("_"+b);c&&c.options.onFormStyled.call()}),this;if("string"==typeof c&&"_"!==c[0]&&"init"!==c){var f;return this.each(function(){var g=a.data(this,"_"+b);g instanceof d&&"function"==typeof g[c]&&(f=g[c].apply(g,Array.prototype.slice.call(e,1)))}),void 0!==f?f:this}},e.registered=!1});
